angular.module("MyApp").controller("MainCtrl",["$scope","$rootScope","fb_appId","$window","$location","Activity","Session","SessionO","Auth","Subscription",function(e,t,r,n,i,o,s,a,c,d){e.cities=["Bangalore","Delhi","Mumbai"],t.currentUser||i.path("/"),n.scrollTo(0,0),e.sortOrders=["New on Joyage","Popular","Upcoming"],e.session=s,e.session.success(function(e){"OK"!=e.session&&(n.fbAsyncInit=function(){FB.init({appId:r,responseType:"token",version:"v2.2",cookie:!0,status:!0,xfbml:!0}),c.logout()})}),e.sessionO=a,e.sessionO.success(function(){}),e.activ=[],e.pagenumber=1,e.gD={Active:"Look, the sun is out. Go for a run, climb a mountain, learn to dance or play a game. Just get up, put the sneakers on and leave the world behind.",Posh:"Enough with the bourgeois. Simplicity is overrated and beige is boring. Nah, choose to be a diva instead. Splurge on luxury, fine dining and upscale shopping. Paint the town bright, bold red.",Calm:"You work hard. Or probably don't. But you deserve to relax a little. Walk in a park, check a museum, find a cafe, read a book, or watch a play. Blur the city noise and find a nirvana.",Adventure:"Do something new today. Something you have never done before. Something different, something crazy. Throw caution to the wind. Enter the realm of unknown.",Party:"Go to a club, hang out with old friends, or make new ones. Mix it up with laughter and karaoke, set the dance floor ablaze. Abandon the real world and just crank the volume up.",Underground:"Legend goes, the beastly creatures of underworld wake up at sundown, roam the dark alleys in search of hidden watering holes and turn every night into a legendary one."},e.gDesc=e.gD.Active,e.city="Bangalore",e.sortSelected="New on Joyage",e.genres=["Active","Posh","Calm","Adventure","Party","Underground"],e.genre="Active",e.headingTitle="all activities",e.sortOrder="timeAdded",e.activities=o.query({page:1,sortOrder:e.sortOrder,city:e.city,genre:e.genre}),e.activ.push(e.activities),e.filterByCity=function(t){e.city=t,e.activ=[],e.activ.push(o.query({page:1,sortOrder:e.sortOrder,city:e.city,genre:e.genre}))},e.filterByGenre=function(t){e.activ=[],e.activ.push(o.query({genre:t,page:1,sortOrder:e.sortOrder,city:e.city})),e.headingTitle=t,e.genre=t;for(var r=document.getElementById("gImg"),n=document.getElementById(t),i=0;i<e.genres.length;i++){var s=document.getElementById(e.genres[i]);s.style.color="black"}n.style.color="rgba(71,162,190,1)",e.gDesc=e.gD[t],"Active"==t?r.src="/img/Active-Mood.jpg":"Posh"==t?r.src="/img/Posh-Mood.jpg":"Calm"==t?r.src="/img/Calm-Mood.jpg":"Adventure"==t?r.src="/img/Adventure-Mood.jpg":"Party"==t?r.src="/img/Party-Mood.jpg":"Underground"==t&&(r.src="/img/Underground-Mood.jpg")},e.allActivities=function(){e.activ=[],e.activ.push(o.query({page:1,sortOrder:e.sortOrder,city:e.city})),e.headingTitle="all activities";document.getElementById("allActivs")},e.pageClick=function(){"all activities"!==e.headingTitle?(e.pagenumber+=1,e.activ.push(o.query({genre:e.headingTitle,page:e.pagenumber,sortOrder:e.sortOrder,city:e.city}))):(e.pagenumber+=1,e.activ.push(o.query({page:e.pagenumber,sortOrder:e.sortOrder,city:e.city})))},e.sort=function(t){1===t?(e.sortOrder="timeAdded",e.sortSelected=e.sortOrders[0]):2===t?(e.sortOrder="popularity",e.sortSelected=e.sortOrders[1]):3===t&&(e.sortOrder="dateOfActivity",e.sortSelected=e.sortOrders[2]),"all activities"!==e.headingTitle?(e.activ=[],e.activ.push(o.query({genre:e.headingTitle,page:1,sortOrder:e.sortOrder,city:e.city}))):(e.activ=[],e.activ.push(o.query({page:1,sortOrder:e.sortOrder,city:e.city})))},e.isSubscribed=function(e){return-1!=e.subscribers.indexOf(t.currentUser._id)?!0:!1},e.subscribe=function(e){poster=document.getElementById("posterSub"),poster.src="img/favicon2.png",d.subscribe(e).success(function(){e.subscribers.push(t.currentUser._id)})},e.unsubscribe=function(e){poster=document.getElementById("posterUnsub"),poster.src="img/favicon.png",d.unsubscribe(e).success(function(){var r=e.subscribers.indexOf(t.currentUser._id);e.subscribers.splice(r,1)})},e.search=function(){},e.userMenu=function(){var e=document.getElementById("user-menu-drawer");e&&e.style&&(e.style.display="block"==e.style.display?"none":"block")},e.sortMenu=function(){var e=document.getElementById("sort-menu-drawer");e&&e.style&&(e.style.display="block"==e.style.display?"none":"block")},e.cityMenu=function(){var e=document.getElementById("city-menu-drawer");e&&e.style&&(e.style.display="block"==e.style.display?"none":"block")}}]);