angular.module("MyApp").controller("InviteCtrl",["$scope","$window","$alert","$routeParams","$http","$route","$interval","fb_appId","fb_connect","Profile","editedProfile","Invites","updateInvites","Session","SessionI","SessionO","Auth",function(e,n,t,i,o,r,s,a,l,f,c,d,u,p,m,y,g){e.session=p,e.session.success(function(e){console.log("Data: "+e.session),"expired"==e.session&&(n.fbAsyncInit=function(){FB.init({appId:a,responseType:"token",version:"v2.2",cookie:!0,status:!0,xfbml:!0}),g.logout()})}),e.sessionI=m,e.sessionI.success(function(e){e.invitePage%2==0&&n.location.reload()}),c.get({_id:i.id},function(i){if(e.profile=i,1!=e.profile.p2p&&e.profile.invitations_sent>=10&&n.location.href("/home"),e.profile.inviteString)randomString=e.profile.inviteString;else{chance.set("lastNames",["Underwood","Stamper","Meechum","Vasquez","Gallagher","Danton","Posner","Barnes","Russo","Bing","Geller","Buffay","Tribbiani","Green","Arryn","Baratheon","Bolton","Frey","Greyjoy","Lannister","Martell","Stark","Targaryen","Tully","Tyrell","Tyrion","Danaerys","Aarya","Rachel","Joey","Ross","Monica","Chandler","Khaleesi","Ned","Jamie","Frank","Chloe","Seinfeld","Jerry","Kramer","Fez","Hyde","Kelso","Forman","Burkhart","Pinciotti","Feynman","Ritchie","Nikola","Tesla","Simon","Garfunkel","Eddie","Vedder","Lennon","Cash"]),randomString=chance.last()+"-"+chance.last()+chance.cc();var o=!0}var f=0;s(function(){1>f&&(n.fbAsyncInit=function(){FB.init({appId:a,responseType:"token",version:"v2.2",oauth:!0,xfbml:!0})},function(e,n,t){var i,o=e.getElementsByTagName(n)[0];e.getElementById(t)||(i=e.createElement(n),i.id=t,i.src=l,o.parentNode.insertBefore(i,o))}(document,"script","facebook-jssdk")),f+=1},10),e.fb_invite=function(){console.log("Im ready to invite")},e.profile.invitations_sent||(e.profile.invitations_sent=0),console.log(randomString),e.fb_request="Ferrell-Stark-Goofy-Biryani"==e.profile.inviteString||"Underwood-Dostoyevsky-Phony-Lannister"==e.profile.inviteString?function(){FB.ui({title:"Joyage invite",method:"apprequests",message:"Select the 10 most beautiful friends to join you on Joyage",max_recipients:1e4},function(n){n&&(e.profile.requests=n.request,e.profile.invitation_to=n.to,e.profile.invitations_sent=n.to.length,e.profile.inviteString=randomString,FB.ui({to:n.to,method:"send",link:"http://joyage.in/login/"+randomString})),o&&d.save({id:randomString}),e.profile.$update(function(){r.reload()})})}:function(){t({content:"Inviting friends",placement:"bottom-left",type:"material",duration:3}),FB.ui({method:"apprequests",title:"Joyage invite",message:"Select the 10 most beautiful friends to join you on Joyage",max_recipients:10-e.profile.invitations_sent,filters:["app_non_users"]},function(n){n&&(e.profile.requests=n.request,e.profile.invitation_to=n.to,e.profile.invitations_sent=n.to.length,e.profile.inviteString=randomString,FB.ui({to:n.to,method:"send",link:"http://joyage.in/login/"+randomString})),o&&d.save({id:randomString}),e.profile.$update(function(){r.reload()}),n||t({content:"failed to invite",placement:"bottom-left",type:"material",duration:3})})}}),e.userMenu=function(){var e=document.getElementById("user-menu-drawer");e&&e.style&&(e.style.display="block"==e.style.display?"none":"block")}}]);