angular.module("MyApp").controller("InviteCtrl",["$scope","$window","$alert","$routeParams","$http","$route","fb_appId","fb_connect","Profile","editedProfile","Invites","updateInvites","Session","Auth",function(e,n,t,i,o,r,a,s,l,c,d,p,f,u){e.session=f,e.session.success(function(e){console.log("Data: "+e.session),"expired"==e.session&&(n.fbAsyncInit=function(){FB.init({appId:a,responseType:"token",version:"v2.2",cookie:!0,status:!0,xfbml:!0}),u.logout()})}),c.get({_id:i.id},function(i){if(e.profile=i,e.profile.inviteString)randomString=e.profile.inviteString;else{chance.set("lastNames",["Underwood","Stamper","Meechum","Vasquez","Gallagher","Danton","Posner","Barnes","Russo","Bing","Geller","Buffay","Tribbiani","Green","Arryn","Baratheon","Bolton","Frey","Greyjoy","Lannister","Martell","Stark","Targaryen","Tully","Tyrell","Tyrion","Danaerys","Aarya","Rachel","Joey","Ross","Monica","Chandler","Khaleesi","Ned","Jamie","Frank","Chloe","Seinfeld","Jerry","Kramer","Fez","Hyde","Kelso","Forman","Burkhart","Pinciotti","Feynman","Ritchie","Nikola","Tesla","Simon","Garfunkel","Eddie","Vedder","Lennon","Cash"]),randomString=chance.last()+"-"+chance.last()+chance.cc();var o=!0}n.fbAsyncInit=function(){FB.init({appId:a,responseType:"token",version:"v2.2",oauth:!0,xfbml:!0})},function(e,n,t){var i,o=e.getElementsByTagName(n)[0];e.getElementById(t)||(i=e.createElement(n),i.id=t,i.src=s,o.parentNode.insertBefore(i,o))}(document,"script","facebook-jssdk"),e.fb_invite=function(){console.log("Im ready to invite")},e.profile.invitations_sent||(e.profile.invitations_sent=0),e.fb_request=function(){t({content:"Inviting friends",placement:"top-right",type:"material",duration:3}),FB.ui({method:"apprequests",message:"Select the 10 most beautiful friends to join you on Joyage",max_recipients:10-e.profile.invitations_sent},function(n){n&&(e.profile.requests=n.request,e.profile.invitation_to=n.to,e.profile.invitations_sent=n.to.length,e.profile.inviteString=randomString,FB.ui({to:n.to,method:"send",name:"Joyage | Discover the best activities in town",link:"http://joyage.in/login/"+randomString})),o&&d.save({id:randomString}),e.profile.$update(function(){r.reload()}),t(n?{content:"successfully invited",placement:"top-right",type:"material",duration:3}:{content:"failed to invite",placement:"top-right",type:"material",duration:3})})}})}]);