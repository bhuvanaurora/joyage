angular.module("MyApp").controller("AddCtrl",["$scope","$alert","$routeParams","$http","$route","$upload","Activity","editedActivity","Profile","Business",function(e,i,t,o,a,n,r,c,s,d){e.businessNames=[],e.listOfBusinesses=d.query({},function(o){for(var m=0;m<o.length;m++)e.businessNames.push(o[m].business);s.get({_id:t.id},function(o){e.profile=o;var s="";e.onFileSelect=function(i){for(var t=0;t<i.length;t++){var o=i[t];e.upload=n.upload({url:"/upload",data:{myObj:e.myModelObj},file:o}).progress(function(e){console.log("percent: "+parseInt(100*e.loaded/e.total))}).success(function(e){s=e.imageurl})}};var m="";e.onPicSelect=function(i){for(var t=0;t<i.length;t++){var o=i[t];e.upload=n.upload({url:"/uploadCornerPic",data:{myObj:e.myModelObj},file:o}).progress(function(e){console.log("percent: "+parseInt(100*e.loaded/e.total))}).success(function(e){m=e.imageurl})}};var l="";e.onMediaImageSelect=function(i){for(var t=0;t<i.length;t++){var o=i[t];e.upload=n.upload({url:"/uploadMediaImage",data:{myObj:e.myModelObj},file:o}).progress(function(e){console.log("percent: "+parseInt(100*e.loaded/e.total))}).success(function(e){l=e.imageurl})}};var p="";e.onVenueImageSelect=function(i){for(var t=0;t<i.length;t++){var o=i[t];e.upload=n.upload({url:"/uploadVenueImage",data:{myObj:e.myModelObj},file:o}).progress(function(e){console.log("percent: "+parseInt(100*e.loaded/e.total))}).success(function(e){p=e.imageurl})}},t.rs||(e.genres=["Athletic Activities","Fitness Classes","Hiking & Biking","Nature Appreciation","Bars","Breweries & Distilleries","Featured Cocktails","Happy Hours","Classes","Exhibits & Galleries","Brunch & Breakfast","Lunch","Dinner","Sweet Treats","Food Trucks & Pop-Ups","Tea & Coffee shops","Concerts","Fun & Games","Nightlife & Parties","Theater & Shows","Activites for Two","Food & Dining","Bars & Drinking"],e.categories=[],e.addCategory=function(i){e.categories.push(i),e.genres.splice(e.genres.indexOf(i),1)},e.removeCategory=function(i){e.categories.splice(e.categories.indexOf(i),1),e.genres.push(i)},e.city="Bangalore",e.country="India",e.currency="&#8377",e.addActivity=function(){-1==e.businessNames.indexOf(e.business)&&d.save({business:e.business,city:e.city,country:e.country}),e.categories.push(e.moods),e.categories.push(e.times);var t,o=e.title.split(" ");t=o.join("-");var a=[];e.mediaTitle1&&a.push({title:e.mediaTitle1,text:e.mediaText1,link:e.mediaLink1}),e.mediaTitle2&&a.push({title:e.mediaTitle2,text:e.mediaText2,link:e.mediaLink2}),e.mediaTitle3&&a.push({title:e.mediaTitle3,text:e.mediaText3,link:e.mediaLink3}),e.mediaTitle4&&a.push({title:e.mediaTitle4,text:e.mediaText4,link:e.mediaLink4}),e.mapLat||e.mapLon||("Bangalore"==e.city?(e.mapLat=12.9539,e.mapLon=77.6309):"Delhi"==e.city?(e.mapLat=28.6336,e.mapLon=77.2225):"Mumbai"==e.city&&(e.mapLat=19.0822,e.mapLon=72.8812)),r.save({id:t,title:e.title,description:e.description,genre:e.categories,dateOfActivity:e.dateOfActivity,endDateOfActivity:e.endDateOfActivity,timeOfActivity:e.timeOfActivity,city:e.city,business:e.business,location:e.location,address:e.address,venueImage:p,venueDescription:e.venueDescription,mediaImage:l,media:a,phone:e.phone,sourceName:e.sourceName,sourceDescription:e.sourceDescription,sourceWebsite:e.sourceWebsite,locationWebsite:e.locationWebsite,neighborhood:e.neighborhood,country:e.country,mapLat:e.mapLat,mapLon:e.mapLon,status:"Continuing",poster:s,photoCredit:e.photoCredit,photoCreditLink:e.photoCreditLink,currency:e.currency,price:e.price,facebookLink:e.facebookLink,twitterLink:e.twitterLink,zomatoLink:e.zomatoLink,payment:e.payment,bookRide:e.bookRide,goodies:e.goodies,moreInfo:e.moreInfo,moreInfoLink:e.moreInfoLink,addedBy:e.addedBy,corner:e.corner,cornerPic:m,cornerText:e.cornerText},function(){e.title="",e.description="",e.categories="",e.dateOfActivity="",e.endDateOfActivity="",e.timeOfActivity="",e.city="",e.business="",e.location="",e.address="",e.phone="",e.venueDescription="",e.venueImage="",e.mediaImage="",e.sourceName="",e.sourceDescription="",e.sourceWebsite="",e.locationWebsite="",e.neighborhood="",e.country="",e.mapLat="",e.mapLon="",e.poster="",e.photoCredit="",e.photoCreditLink="",e.price="",e.facebookLink="",e.twitterLink="",e.zomatoLink="",e.payment="",e.bookRide="",e.goodies="",e.moreInfo="",e.moreInfoLink="",e.corner="",e.cornerPic="",e.cornerText="",a=[],i({content:"Activity has been added.",placement:"top-right",type:"success",duration:3})},function(e){i({content:e.data.message,placement:"top-right",type:"material",duration:3})})}),t.rs&&(c.get({_id:t.rs},function(i){e.activity=i,e.categories=[],e.filterMoods=["Active","Posh","Fun","Adventure","Party","Underground"],e.moods="",e.filterTimes=["Morning","Afternoon","Evening","Afterdark"],e.times="";for(var t=0;t<i.genre.length;t++)null!=i.genre[t]&&(-1!==e.filterMoods.indexOf(i.genre[t])?e.moods=i.genre[t]:-1!==e.filterTimes.indexOf(i.genre[t])?e.times=i.genre[t]:e.categories.push(i.genre[t]));if(e.genres=["Athletic Activities","Fitness Classes","Hiking & Biking","Nature Appreciation","Bars","Breweries & Distilleries","Featured Cocktails","Happy Hours","Classes","Exhibits & Galleries","Brunch & Breakfast","Lunch","Dinner","Sweet Treats","Food Trucks & Pop-Ups","Tea & Coffeeshops","Concerts","Fun & Games","Nightlife & Parties","Theater & Shows","Activites for Two","Food & Dining","Bars & Drinking"],i.genre)for(var t=0;t<e.categories.length;t++)e.genres.splice(e.genres.indexOf(e.categories[t]),1);e.addCategory=function(i){e.categories.push(i),e.genres.splice(e.genres.indexOf(i),1)},e.removeCategory=function(i){e.categories.splice(e.categories.indexOf(i),1),e.genres.push(i)},e.title=i.title,e.description=i.description,e.dateOfActivity=i.dateOfActivity,e.endDateOfActivity=i.endDateOfActivity,e.timeOfActivity=i.timeOfActivity,e.business=i.business,e.location=i.location,e.city=i.city,e.address=i.address,i.media[0]&&(e.mediaTitle1=i.media[0].title,e.mediaText1=i.media[0].text,e.mediaLink1=i.media[0].link),i.media[1]&&(e.mediaTitle2=i.media[1].title,e.mediaText2=i.media[1].text,e.mediaLink2=i.media[1].link),i.media[2]&&(e.mediaTitle3=i.media[2].title,e.mediaText3=i.media[2].text,e.mediaLink3=i.media[2].link),i.media[3]&&(e.mediaTitle4=i.media[3].title,e.mediaText4=i.media[3].text,e.mediaLink4=i.media[3].link),e.mediaImage=i.mediaImage,e.phone=i.phone,e.venueImage=i.venueImage,e.venueDescription=i.venueDescription,e.sourceName=i.sourceName,e.sourceDescription=i.sourceDescription,e.sourceWebsite=i.sourceWebsite,e.locationWebsite=i.locationWebsite,e.neighborhood=i.neighborhood,e.city=i.city,e.country=i.country,e.poster=i.poster,e.photoCredit=i.photoCredit,e.photoCreditLink=i.photoCreditLink,e.mapLat=i.mapLat,e.mapLon=i.mapLon,e.currency=i.currency,e.price=i.price,e.facebookLink=i.facebookLink,e.twitterLink=i.twitterLink,e.zomatoLink=i.zomatoLink,e.payment=i.payment,e.bookRide=i.bookRide,e.goodies=i.goodies,e.moreInfo=i.moreInfo,e.moreInfoLink=i.moreInfoLink,e.addedBy=i.addedBy,e.corner=i.corner,e.cornerPic=i.cornerPic,e.cornerText=i.cornerText,e.mediaImage=i.mediaImage}),e.addActivity=function(){e.categories.push(e.moods),e.categories.push(e.times);var i,t=e.title.split(" ");i=t.join("-");var o=[];e.mediaTitle1&&o.push({title:e.mediaTitle1,text:e.mediaText1,link:e.mediaLink1}),e.mediaTitle2&&o.push({title:e.mediaTitle2,text:e.mediaText2,link:e.mediaLink2}),e.mediaTitle3&&o.push({title:e.mediaTitle3,text:e.mediaText3,link:e.mediaLink3}),e.mediaTitle4&&o.push({title:e.mediaTitle4,text:e.mediaText4,link:e.mediaLink4}),e.mapLat||e.mapLon||("Bangalore"==e.city?(e.mapLat=12.9539,e.mapLon=77.6309):"Delhi"==e.city?(e.mapLat=28.6336,e.mapLon=77.2225):"Mumbai"==e.city&&(e.mapLat=19.0822,e.mapLon=72.8812)),""!=s&&e.poster!=s&&(e.poster=s),""!=p&&e.venueImage!=p&&(e.venueImage=p),""!=m&&e.cornerPic!=m&&(e.cornerPic=m),""!=l&&e.mediaImage!=l&&(e.mediaImage=l),e.activity.title=e.title,e.activity.description=e.description,e.activity.genre=e.categories,e.activity.dateOfActivity=e.dateOfActivity,e.activity.endDateOfActivity=e.endDateOfActivity,e.activity.timeOfActivity=e.timeOfActivity,e.activity.business=e.business,e.activity.location=e.location,e.activity.city=e.city,e.activity.address=e.address,e.activity.media=o,e.activity.phone=e.phone,e.activity.venueImage=e.venueImage,e.activity.venueDescription=e.venueDescription,e.activity.sourceName=e.sourceName,e.activity.sourceDescription=e.sourceDescription,e.activity.sourceWebsite=e.sourceWebsite,e.activity.locationWebsite=e.locationWebsite,e.activity.neighborhood=e.neighborhood,e.activity.city=e.city,e.activity.country=e.country,e.activity.mapLat=e.mapLat,e.activity.mapLon=e.mapLon,e.activity.poster=e.poster,e.activity.photoCredit=e.photoCredit,e.activity.photoCreditLink=e.photoCreditLink,e.activity.currency=e.currency,e.activity.price=e.price,e.activity.facebookLink=e.facebookLink,e.activity.twitterLink=e.twitterLink,e.activity.zomatoLink=e.zomatoLink,e.activity.payment=e.payment,e.activity.bookRide=e.bookRide,e.activity.goodies=e.goodies,e.activity.moreInfo=e.moreInfo,e.activity.moreInfoLink=e.moreInfoLink,e.activity.corner=e.corner,e.activity.cornerPic=e.cornerPic,e.activity.cornerText=e.cornerText,e.activity.mediaImage=e.mediaImage,e.activity.$update(function(){a.reload()})})})})}]);